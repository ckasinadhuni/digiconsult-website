version: '3.8'

services:
  pocketbase:
    image: ghcr.io/muchobien/pocketbase:latest
    container_name: digiconsult-pocketbase-auth
    restart: unless-stopped
    ports:
      - "8091:8090"  # Use 8091 to avoid conflicts
    volumes:
      - ./data:/pb_data
      - ./public:/pb_public  
      - ./migrations:/pb_migrations
    environment:
      - TZ=America/Toronto
    networks:
      - n8n_net
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:8090/api/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 15s
    labels:
      - "traefik.enable=false"  # We're using Caddy, not Traefik

networks:
  n8n_net:
    external: true